<div class="register-container">
  <div class="register-header">
    <h1>Create Account</h1>
    <p>Sign up to get started with our application</p>
  </div>

  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
    <!-- Two-column layout for name fields -->
    <div class="name-fields">
      <mat-form-field appearance="outline">
        <mat-label>First Name</mat-label>
        <mat-icon matPrefix>person</mat-icon>
        <input matInput formControlName="firstName" placeholder="John">
        
        <mat-error *ngIf="registerForm.get('firstName')?.hasError('required')">
          First name is required
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Last Name</mat-label>
        <input matInput formControlName="lastName" placeholder="Doe">
        
        <mat-error *ngIf="registerForm.get('lastName')?.hasError('required')">
          Last name is required
        </mat-error>
      </mat-form-field>
    </div>

    <!-- Username -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Username</mat-label>
      <mat-icon matPrefix>alternate_email</mat-icon>
      <input matInput formControlName="username" placeholder="johndoe">
      
      <mat-hint>Must be unique, 3-20 characters</mat-hint>
      <mat-error *ngIf="registerForm.get('username')?.hasError('required')">
        Username is required
      </mat-error>
      <mat-error *ngIf="registerForm.get('username')?.hasError('minlength')">
        Username must be at least 3 characters
      </mat-error>
      <mat-error *ngIf="registerForm.get('username')?.hasError('maxlength')">
        Username must be less than 20 characters
      </mat-error>
    </mat-form-field>

    <!-- Email -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Email Address</mat-label>
      <mat-icon matPrefix>email</mat-icon>
      <input matInput type="email" formControlName="email" placeholder="john@example.com">
      
      <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
        Email is required
      </mat-error>
      <mat-error *ngIf="registerForm.get('email')?.hasError('email')">
        Please enter a valid email address
      </mat-error>
    </mat-form-field>

    <!-- Password -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Password</mat-label>
      <mat-icon matPrefix>lock</mat-icon>
      <input matInput [type]="hidePassword ? 'password' : 'text'" 
             formControlName="password" placeholder="Create a password">
      
      <button mat-icon-button matSuffix type="button" 
              (click)="hidePassword = !hidePassword"
              [attr.aria-label]="'Hide password'">
        <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      
      <mat-hint>Minimum 8 characters with letters and numbers</mat-hint>
      <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
        Password is required
      </mat-error>
      <mat-error *ngIf="registerForm.get('password')?.hasError('minlength')">
        Password must be at least 8 characters
      </mat-error>
      <mat-error *ngIf="registerForm.get('password')?.hasError('pattern')">
        Password must contain letters and numbers
      </mat-error>
    </mat-form-field>

    <!-- Confirm Password -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Confirm Password</mat-label>
      <mat-icon matPrefix>lock_reset</mat-icon>
      <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" 
             formControlName="confirmPassword" placeholder="Confirm your password">
      
      <button mat-icon-button matSuffix type="button" 
              (click)="hideConfirmPassword = !hideConfirmPassword"
              [attr.aria-label]="'Hide password'">
        <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      
      <mat-error *ngIf="registerForm.hasError('passwordMismatch')">
        Passwords do not match
      </mat-error>
    </mat-form-field>

    <!-- Terms Agreement -->
    <div class="terms-agreement">
      <mat-checkbox formControlName="agreeToTerms" color="primary">
        I agree to the 
        <a href="#" (click)="showTerms($event)">Terms of Service</a> 
        and 
        <a href="#" (click)="showPrivacy($event)">Privacy Policy</a>
      </mat-checkbox>
      
      <mat-error *ngIf="registerForm.get('agreeToTerms')?.hasError('required')">
        You must agree to the terms
      </mat-error>
    </div>

    <!-- Submit Button -->
    <button mat-raised-button color="primary" type="submit" class="submit-button" 
            [disabled]="registerForm.invalid || isLoading">
      <span *ngIf="!isLoading">
        <mat-icon>person_add</mat-icon>
        Create Account
      </span>
      <span *ngIf="isLoading">
        <mat-spinner diameter="20" class="button-spinner"></mat-spinner>
        Creating Account...
      </span>
    </button>

    <!-- Divider -->
    <mat-divider class="divider"></mat-divider>

    <!-- Login Link -->
    <div class="login-link">
      <p>Already have an account? <a routerLink="/auth/login">Sign in here</a></p>
    </div>
  </form>

  <!-- Success/Error Messages -->
  <div *ngIf="successMessage" class="success-alert">
    <mat-icon class="success-icon">check_circle</mat-icon>
    <span>{{ successMessage }}</span>
  </div>

  <div *ngIf="errorMessage" class="error-alert">
    <mat-icon class="error-icon">error</mat-icon>
    <span>{{ errorMessage }}</span>
  </div>
</div>